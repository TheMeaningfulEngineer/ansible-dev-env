---

    - name: Add nvim-lspconfig so plug can install it
      lineinfile:
        path: "{{ LOCAL_DOT_CONFIG_PATH }}/nvim/init.vim"
        insertbefore: "call plug#end()"
        line: "Plug 'neovim/nvim-lspconfig'"

    - name: Install nvim plug plugins
      shell: nvim --headless +PlugInstall +qa

    - name: Modify bashrc to add aliases for vim and vi
      blockinfile:
        path: "{{ LOCAL_DOT_CONFIG_PATH }}/nvim/init.vim"
        marker: "\" {mark} ANSIBLE MANAGED BLOCK [nvim-lsp-agnostic]"
        block: |
            nnoremap <silent> <leader>a  <cmd>lua vim.lsp.buf.definition()<CR>
            nnoremap <silent> <leader>s  <cmd>lua vim.lsp.buf.hover()<CR>
            nnoremap <silent> <leader>d  <cmd>lua vim.lsp.buf.references()<CR>
            nnoremap <silent> <leader>f  <cmd>lua vim.lsp.buf.document_symbol()<CR>
            set updatetime=200
